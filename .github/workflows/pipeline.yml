name: Deploy Angular Project to GitHub Pages

#on:
 # push:
  #  branches:
   #   - main

#name: Build and Deploy
on: [push]
#permissions:
 # contents: write
# jobs:
#   build-and-deploy:
#     concurrency: ci-${{ github.ref }} # Recommended if you intend to make multiple deployments in quick succession.
        
env:
  GITHUB_TOKEN: ${{secrets.ACCESS_TOKEN_SECRET }}

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2
    # node enviroment
    - run : echo "::github_token::$secrets.ACCESS_TOKEN_SECRET" 
    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: 18.14.0

    - name: Install dependencies
      run: npm ci

    - name: Install Angular 
      run: npm install -g @angular/cli

    # - name: Build and run Angular app 
    #   run: ng serve
          
    - name: Install gh-pages cli 
      run: ng add angular-cli-ghpages

    - name: Deploy Angular App 
      run: ng deploy

    # - name: Deploy to Gitpages
    #   uses: JamesIves/github-pages-deploy-action@releases/v3
    #   with:
    #     ACCESS_TOKEN: ${{ env.ACCESS_TOKEN_SECRET }}
    #     BRANCH: gh-pages
    #     FOLDER: dist/my-angular-project